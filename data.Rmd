---
title: "Fe-BR: Base de Dados Brasileira de Ferro do Solo"
---

## DADOS

Aqui você fica sabendo mais sobre as contribuições com dados de ferro do solo que já recebemos. Mas antes de
começar, é preciso esclarecer que as contribuições são classificadas de acordo com o tipo de dado, ou seja, 
pedológicos ou edafológicos (veja mais informações abaixo). As duas maiores contribuições de cada tipo de dado 
de ferro do solo serão premiadas com a coautoria de um artigo a ser submetido para publicação na revista 
[Earth System Science Data](http://earth-system-science-data.net/) (Fator de Impacto > 8).

Veja quem já contribuiu!

```{r, echo=FALSE}
# Retornar o nome dos arquivos contendo as contribuições. Por padrão, o nome dos arquivos inicia com 'ctb'
# e termina com 'csv'.
ctb <- list.files("data", pattern = "[^ctb][^.][csv$]")
ctb <- paste("data/", ctb, sep = "")
ctb <- lapply(ctb, read.csv, header = TRUE, stringsAsFactors = FALSE)
```

```{r, echo=FALSE}
rank <- 
  function (people) {
    people <- people[order(people$Contribuição, decreasing = TRUE), ]
    people <- cbind(Posição = 1:nrow(people), people)
    rownames(people) <- NULL
    return (people)
  }
```

## Dados Pedológicos

Dados pedológicos são aqueles dados oriundos de atividades mais diretamente relacionadas ao 
estudo da gênese, morfologia e classificação do solo, por vezes tendo servido para o mapeamento do solo. Dados 
pedológicos costumam ser obtidos a partir da amostragem de perfis do solo, descritos completa ou 
incompletamente, onde a unidade amostral básica é definida como sendo um horizonte. Os limites superior e 
inferior de um horizonte costumam ser definidos com base na observação de características relacionadas aos 
processos de formação do solo.

```{r, echo=FALSE}
# Identificar as contribuições pedológicas
pedology <- lapply(ctb, function (x) x[x$Tipo == "PEDOLÓGICO", ])
pedology <- pedology[sapply(pedology, nrow) != 0]
# Agregar dados por contribuição
pedology <- lapply(pedology, function (x) {
  n <- nrow(x)
  uf <- ifelse(n == 27, "Brasil", x$UF)
  name <- unique(x$Nome)
  inst <- unique(x$Instituição)
  number <- sum(x$Contribuição)
  data.frame(Nome = name, Instituição = inst, uf = uf, Contribuição = number)
})
pedology <- do.call(rbind, pedology)
knitr::kable(
  rank(pedology[, -3]), format = "html", table.attr = "width='100%'", 
  caption = "Classificação dos cientistas do solo que contribuíram com dados pedológicos de ferro do solo.")
```

## Dados Edafológicos

Dados edafológicos são dados cuja origem são os diversos estudos do solo relacionados à sua
química, fertilidade, física, conservação, biologia, entre outros. Os dados edafológicos também podem ter 
servido para o mapeamento do solo. Contudo, diferente dos dados pedológicos, a unidade amostral básica do solo
para obtenção de dados edafológicos é definida como sendo uma camada. As dimensões de uma camada 
amostral costumam ser definidas com base em critérios operacionais ou padrões mais ou menos aceitos pela 
comunidade científica.

```{r, echo=FALSE}
# Identificar as contribuições pedológicas
edafology <- lapply(ctb, function (x) x[x$Tipo == "EDAFOLÓGICO", ])
edafology <- edafology[sapply(edafology, nrow) != 0]
# Agregar dados por contribuição
edafology <- lapply(edafology, function (x) {
  n <- nrow(x)
  uf <- ifelse(n == 27, "Brasil", x$UF)
  name <- unique(x$Nome)
  inst <- unique(x$Instituição)
  number <- sum(x$Contribuição)
  data.frame(Nome = name, Instituição = inst, uf = uf, Contribuição = number)
})
edafology <- do.call(rbind, edafology)
knitr::kable(
  rank(edafology[, -3]), format = "html", table.attr = "width='100%'",
    caption = "Classificação dos cientistas do solo que contribuíram com dados edafológicos de ferro do solo.")
```

## Distribuição Territorial

```{r, echo=FALSE}
fe_data <- do.call(rbind, ctb)[, c("UF", "Contribuição")]
fe_data <- by(fe_data$Contribuição, fe_data$UF, sum)
states <- raster::shapefile("data/states.shp")
idx <- states$uf %in% names(fe_data)
states$n <- 0
states$n[idx] <- fe_data[states$uf[idx]]
tmp <- sp::spTransform(
  states, "+proj=utm +zone=24 +south +ellps=aust_SA +towgs84=-57,1,-41,0,0,0,0 +units=m +no_defs")
states$d <- states$n / (rgeos::gArea(tmp, byid = TRUE) / 1e6)
```

Que tal ver como as contribuições com dados de ferro do solo estão distribuídas no território brasileiro?

A primeira figura mostra o número de registros (amostras de horizontes e camadas) em cada uma das unidades da federação. `r states$uf[which.max(states$n)]` concentra o maior número de registros até agora (`r max(states$n)`), enquanto `r states$uf[which.min(states$n)]` possui o menor número de registros (`r min(states$n)`) na base de dados de ferro do solo.
`r if(states$uf[which.max(states$n)] == "MG") paste("É interessante que MG tenha o maior número de registro, sendo o estado brasileiro onde os maiores valores de conteúdo de ferro do solo costumam ser reportados.")`
`r if(states$uf[which.min(states$n)] == "TO") paste("No caso do TO, o reduzido número de registros deve-se", "ao fato de muitos estudos terem sido realizados antes da sua emancipação em 5 de outubro de 1988.")`
`r if("RJ" %in% states@data[order(states$n, decreasing = TRUE), ]$uf[1:5]) paste("O fato de o RJ estar entre os cinco estados com maior número de registros (", states$n[which(states$uf == "RJ")], ") sugere uma maior atividade dos órgãos oficiais de pesquisa pedológica como a Embrapa Solos em seu estado sede.", sep = "")`

```{r, echo=FALSE}
sp::spplot(
  states, "n", col.regions = rev(terrain.colors(100)), scales = list(draw = TRUE), 
  main = "Número de registros", xlab = "Longitude", ylab = "Latitude")
```

A figura muda quando olhamos para a densidade de registros, ou seja, o número de registros por quilômetro
quadrado na base de dados de ferro do solo. Até o momento, `r states$uf[which.max(states$d)]` possui a maior 
densidade de registros (`r round(max(states$d), 4)`). Já `r states$uf[which.min(states$d)]` apresenta a menor 
densidade de registros por quilômetro quadrado ($`r round(min(states$d), 6)`$)
`r if(states$uf[which.min(states$n)] == "TO") paste("-- pelo motivo já explicado acima")`.


```{r, echo=FALSE}
sp::spplot(
  states, "d", col.regions = rev(terrain.colors(100)), scales = list(draw = TRUE),
  main = "Densidade de registros", xlab = "Longitude", ylab = "Latitude")
```

